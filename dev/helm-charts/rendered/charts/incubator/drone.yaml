---
# Source: drone/templates/secrets.yaml
apiVersion: v1
kind: Secret
metadata:
  name: RELEASE-NAME-drone
  labels:
    app: drone
    chart: "drone-1.1.1"
    release: "RELEASE-NAME"
    heritage: "Tiller"
type: Opaque
data:
  
  secret: "eUdZQ3hrQTM2WWlMbk1DUFpZbDUwcHVp"
  

---
# Source: drone/templates/pvc.yaml

kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: RELEASE-NAME-drone
spec:
  accessModes:
    - "ReadWriteOnce"
  resources:
    requests:
      storage: "1Gi"

---
# Source: drone/templates/service-account.yaml

apiVersion: v1
kind: ServiceAccount
metadata:
  name: RELEASE-NAME-drone
  labels:
    app: drone
    chart: "drone-1.1.1"
    release: "RELEASE-NAME"
    heritage: "Tiller"


---
# Source: drone/templates/role.yaml

apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: RELEASE-NAME-drone
  labels:
    app: drone
    chart: "drone-1.1.1"
    release: "RELEASE-NAME"
    heritage: "Tiller"
rules:
  - apiGroups:
      - extensions
    resources:
      - deployments
    verbs:
      - get
      - list
      - patch
      - update


---
# Source: drone/templates/role-binding.yaml

apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: RELEASE-NAME-drone
  labels:
    app: drone
    chart: "drone-1.1.1"
    release: "RELEASE-NAME"
    heritage: "Tiller"
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: RELEASE-NAME-drone
subjects:
- kind: ServiceAccount
  name: RELEASE-NAME-drone
  namespace: hub


---
# Source: drone/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: RELEASE-NAME-drone
  labels:
    app: drone
    chart: "drone-1.1.1"
    release: "RELEASE-NAME"
    heritage: "Tiller"
spec:
  type: ClusterIP
  ports:
  - name: http
    port: 80
    targetPort: 8000
  - name: grpc
    port: 9000
    targetPort: 9000
  selector:
    app: drone
    release: "RELEASE-NAME"
    component: server

---
# Source: drone/templates/deployment-agent.yaml
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: RELEASE-NAME-drone-agent
  labels:
    app: drone
    chart: "drone-1.1.1"
    release: "RELEASE-NAME"
    heritage: "Tiller"
    component: agent
spec:
  replicas: 1
  template:
    metadata:
      annotations:
        checksum/secrets: f0659c0caa12fb08a4aee14baa2e777ace65b1e2ea2e973b55084a759e956aa0
      labels:
        app: drone
        release: "RELEASE-NAME"
        component: agent
    spec:
      serviceAccountName: RELEASE-NAME-drone
      containers:
      - name: RELEASE-NAME-drone-agent
        image: "docker.io/drone/agent:0.8.5"
        imagePullPolicy: IfNotPresent
        env:
          - name: DRONE_SERVER
            value: RELEASE-NAME-drone:9000
          - name: DRONE_SECRET
            valueFrom:
              secretKeyRef:
                name: RELEASE-NAME-drone
                key: secret
          - name: DOCKER_HOST
            value: tcp://localhost:2375
          - name: DRONE_DEBUG
            value: "false"
        resources:
          {}
          
      - name: RELEASE-NAME-drone-dind
        image: "docker.io/library/docker:17.12.0-ce-dind"
        imagePullPolicy: IfNotPresent
        env:
        - name: DOCKER_DRIVER
          value: overlay2
        
        securityContext:
          privileged: true
        resources:
          {}
          
        volumeMounts:
          - name: docker-graph-storage
            mountPath: /var/lib/docker
      volumes:
      - name: docker-graph-storage
        emptyDir: {}

---
# Source: drone/templates/deployment-server.yaml


---
# Source: drone/templates/ingress.yaml

